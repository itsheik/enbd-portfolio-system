### **BASIC Wallet**

This is a simple wallet API that allows you to create accounts, charge accounts, and top up accounts. It is built using Node.js, TypeScript, and Express, and uses SQLite as the database with Prisma as the ORM.

The API is documented using Postman. You can find the collection in the `Basic Wallet.postman_collection.json` file.

### **Prerequisites**

- Node.js should be installed.

### **Setup**

1. Clone the repository.
2. Run `npm install` to install dependencies.
3. Run `npm run migrate` to create the database.

### **Running Unit Tests**

- Run `npm run test` to execute unit tests.

### **Running the Server**

- **Development Mode**:
  - Run `npm run dev`.
- **Production Mode**:
  - Run `npm run build`.
  - Run `npm start`.

### **Database Schema**

```sql
-- CreateTable
CREATE TABLE "Account" (
    "id" TEXT NOT NULL PRIMARY KEY,
    "holderName" TEXT NOT NULL,
    "balance" REAL NOT NULL DEFAULT 0.00,
    "currency" TEXT NOT NULL,
    "createdAt" DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" DATETIME NOT NULL
);

-- CreateTable
CREATE TABLE "Transaction" (
    "id" TEXT NOT NULL PRIMARY KEY,
    "type" TEXT NOT NULL,
    "accountId" TEXT NOT NULL,
    "amount" REAL NOT NULL,
    "currency" TEXT NOT NULL,
    "operationId" TEXT NOT NULL,
    "createdAt" DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" DATETIME NOT NULL,
    CONSTRAINT "Transaction_accountId_fkey" FOREIGN KEY ("accountId") REFERENCES "Account" ("id") ON DELETE RESTRICT ON UPDATE CASCADE
);

-- CreateIndex
CREATE UNIQUE INDEX "Transaction_operationId_key" ON "Transaction"("operationId");
```

### **Database Explanation**

- The `Account` table stores information about wallet accounts.
- The `Transaction` table stores details about the transactions made on the accounts.
- The `Transaction_operationId_key` index ensures that only one transaction can be created for a given `operationId`.
- The `operationId` will be generated by the server and sent to the client before initializing the transaction, acting as an idempotency token.

### **Layer Architecture**

- **Controller**: Handles incoming requests and delegates the work to the use cases.
- **Use Cases**: Manages the business logic of the application.
- **Prisma Client**: Handles database operations.
